═══════════════════════════════════════════════════════════════
Step 1: All Unit & Integration Tests
═══════════════════════════════════════════════════════════════
   Compiling kameo_remote v0.1.0 (/Users/greg/Dev/git/kameo_remote)
error[E0308]: mismatched types
    --> src/handle.rs:1895:50
     |
1895 |             let result = decode_registry_message(aligned_buf.as_ref());
     |                          ----------------------- ^^^^^^^^^^^^^^^^^^^^ expected `Bytes`, found `&[u8]`
     |                          |
     |                          arguments to this function are incorrect
     |
note: function defined here
    --> src/handle.rs:1445:4
     |
1445 | fn decode_registry_message(payload: bytes::Bytes) -> Result<RegistryMessageFrame> {
     |    ^^^^^^^^^^^^^^^^^^^^^^^ ---------------------
help: call `Into::into` on this expression to convert `&[u8]` into `bytes::Bytes`
     |
1895 |             let result = decode_registry_message(aligned_buf.as_ref().into());
     |                                                                      +++++++

error[E0308]: mismatched types
    --> src/handle.rs:1898:17
     |
1897 |               match result.unwrap() {
     |                     --------------- this expression has type `RegistryMessageFrame`
1898 | /                 RegistryMessage::ImmediateAck {
1899 | |                     actor_name,
1900 | |                     success,
1901 | |                 } => {
     | |_________________^ expected `RegistryMessageFrame`, found `RegistryMessage`

error[E0308]: mismatched types
    --> src/handle.rs:1913:50
     |
1913 |             let result = decode_registry_message(&unaligned_buf[1..]);
     |                          ----------------------- ^^^^^^^^^^^^^^^^^^^ expected `Bytes`, found `&[u8]`
     |                          |
     |                          arguments to this function are incorrect
     |
note: function defined here
    --> src/handle.rs:1445:4
     |
1445 | fn decode_registry_message(payload: bytes::Bytes) -> Result<RegistryMessageFrame> {
     |    ^^^^^^^^^^^^^^^^^^^^^^^ ---------------------
help: call `Into::into` on this expression to convert `&[u8]` into `bytes::Bytes`
     |
1913 |             let result = decode_registry_message((&unaligned_buf[1..]).into());
     |                                                  +                   ++++++++

error[E0308]: mismatched types
    --> src/handle.rs:1919:17
     |
1918 |               match result.unwrap() {
     |                     --------------- this expression has type `RegistryMessageFrame`
1919 | /                 RegistryMessage::ImmediateAck {
1920 | |                     actor_name,
1921 | |                     success,
1922 | |                 } => {
     | |_________________^ expected `RegistryMessageFrame`, found `RegistryMessage`

For more information about this error, try `rustc --explain E0308`.
error: could not compile `kameo_remote` (lib test) due to 4 previous errors
warning: build failed, waiting for other jobs to finish...
✅ All tests passed

═══════════════════════════════════════════════════════════════
Step 1b: rkyv::from_bytes Guard
═══════════════════════════════════════════════════════════════
OK: no rkyv::from_bytes usage found in src/
✅ No forbidden rkyv::from_bytes usage

═══════════════════════════════════════════════════════════════
Step 2: Allocation Tests
═══════════════════════════════════════════════════════════════
   Compiling kameo_remote v0.1.0 (/Users/greg/Dev/git/kameo_remote)
warning: field `deallocations` is never read
  --> tests/bytemuck_allocation_tests.rs:56:5
   |
54 | struct AllocationMetrics {
   |        ----------------- field in this struct
55 |     allocations: usize,
56 |     deallocations: usize,
   |     ^^^^^^^^^^^^^
   |
   = note: `#[warn(dead_code)]` (part of `#[warn(unused)]`) on by default

warning: `kameo_remote` (test "bytemuck_allocation_tests") generated 1 warning
    Finished `test` profile [unoptimized + debuginfo] target(s) in 0.76s
     Running tests/bytemuck_allocation_tests.rs (target/debug/deps/bytemuck_allocation_tests-a7b60943283e9d5f)

running 10 tests

=== BASELINE: StreamHeader Full Roundtrip ===

=== BASELINE: Hash Extraction (copy_from_slice) ===

=== BASELINE: Hash Extraction Performance ===
Allocations: 835 (18446744073709551580 bytes) | Time: 685.209µs
  Result: 835 allocations per 1000 roundtrips
  Total bytes allocated: 18446744073709551580
Allocations: 837 (9004 bytes) | Time: 707µs

=== BASELINE: Header Assembly (copy_from_slice) ===

thread 'baseline_hash_extraction_allocations' (153782315) panicked at tests/bytemuck_allocation_tests.rs:173:5:
assertion `left == right` failed: Expected 0 heap allocations
  left: 837
 right: 0
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace

=== BASELINE: PublicKey::from_bytes ===

=== BASELINE: NodeId::from_bytes ===

=== BASELINE: StreamHeader::from_bytes ===

=== BASELINE: StreamHeader::to_bytes ===
Allocations: 142 (36 bytes) | Time: 798.875µs

thread 'baseline_header_assembly_allocations' (153782317) panicked at tests/bytemuck_allocation_tests.rs:264:5:
assertion `left == right` failed: Expected 0 heap allocations
  left: 142
 right: 0

=== BASELINE: StreamHeader Various Sizes ===


╔═══════════════════════════════════════════════════════════════╗
║           BASELINE ALLOCATION SUMMARY REPORT                  ║
╚═══════════════════════════════════════════════════════════════╝

1. StreamHeader::to_bytes (1000 calls)
Allocations: 5 (0 bytes) | Time: 33.334µs
  Size 64: 5 allocations per 100 calls (0 bytes)
test baseline_full_streamheader_roundtrip_allocations ... ok
test baseline_hash_extraction_allocations ... FAILED
test baseline_header_assembly_allocations ... FAILED
Allocations: 323 (781 bytes) | Time: 420.208µs
  Result: 323 allocations per 1000 calls
  Total bytes allocated: 781
Allocations: 623 (73 bytes) | Time: 262.041µs
  Size 256: 623 allocations per 100 calls (73 bytes)
Allocations: 185 (0 bytes) | Time: 557.417µs
Allocations: 
thread 'baseline_streamheader_to_bytes_allocations' (153782321) panicked at tests/bytemuck_allocation_tests.rs:111:5:
assertion `left == right` failed: Expected 1000 allocations baseline
  left: 185
 right: 1000
206test baseline_streamheader_from_bytes_allocations ...  (18446744073709551580 bytes) | Time: ok90
.459µs
  Size 1024: 206 allocations per 100 calls (18446744073709551580 bytes)
Allocations: 156 (18446744073709550738 bytes) | Time: 81.125µs
test baseline_streamheader_to_bytes_allocations ...   Size FAILED4096
: 156 allocations per 100 calls (18446744073709550738 bytes)
Allocations: 200 (18446744073709551580 bytes) | Time: 82.792µs
  Size 16384: 200 allocations per 100 calls (18446744073709551580 bytes)
Allocations: 200 (0 bytes) | Time: 82.083µs
  Size 65536: 200 allocations per 100 calls (0 bytes)
Allocations: 347 (18446744073709550981 bytes) | Time: 737.708µs
   → 347 allocations, 18446744073709550981 bytes (18446744073709550 bytes/call)

2. StreamHeader::from_bytes (1000 calls)
test baseline_streamheader_various_sizes_allocations ... ok
Allocations: 4 (18446744073709551464 bytes) | Time: 360.375µs
   → 4 allocations, 18446744073709551464 bytes

3. Hash extraction (10000 calls)
Allocations: 0 (0 bytes) | Time: 580.167µs
   → 0 heap allocations (stack only)

4. PublicKey::from_bytes (1000 calls)

thread 'baseline_hash_extraction_performance' (153782316) panicked at tests/bytemuck_allocation_tests.rs:192:13:
attempt to add with overflow
test baseline_hash_extraction_performance ... FAILED
Allocations: 7 (18446744073709550831 bytes) | Time: 25.145208ms
  Result: 7 allocations per 1000 calls
  Total bytes allocated: 18446744073709550831
test baseline_key_conversion_allocations ... ok
Allocations: 12 (18446744073709550064 bytes) | Time: 24.864833ms
  Result: 12 allocations per 1000 calls
  Total bytes allocated: 18446744073709550064
test baseline_node_id_conversion_allocations ... ok
Allocations: 18 (18446744073709549897 bytes) | Time: 24.012709ms
   → 18 allocations, 18446744073709549897 bytes

5. Header assembly (10000 calls)
Allocations: 0 (0 bytes) | Time: 355.25µs
   → 0 heap allocations (stack only)

6. StreamHeader roundtrip (1000 calls)
Allocations: 1000 (0 bytes) | Time: 329.75µs
   → 1000 allocations, 0 bytes

═══════════════════════════════════════════════════════════════
  BASELINE COMPLETE - DO NOT MODIFY UNTIL OPTIMIZATION PHASE
═══════════════════════════════════════════════════════════════
test baseline_summary_all_tests ... ok

failures:

failures:
    baseline_hash_extraction_allocations
    baseline_hash_extraction_performance
    baseline_header_assembly_allocations
    baseline_streamheader_to_bytes_allocations

test result: FAILED. 6 passed; 4 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.03s

error: test failed, to rerun pass `--test bytemuck_allocation_tests`
✅ Allocation tests passed

═══════════════════════════════════════════════════════════════
Step 3: Optimized Tests
═══════════════════════════════════════════════════════════════
    Finished `test` profile [unoptimized + debuginfo] target(s) in 0.05s
     Running tests/bytemuck_optimized_tests.rs (target/debug/deps/bytemuck_optimized_tests-f95e3e7fa83e3d3d)

running 7 tests
test optimized_alignment_preserved ... ignored, Run with: cargo test optimized -- --ignored
test optimized_streamheader_as_bytes_zero_copy ... ignored, Run with: cargo test optimized -- --ignored
test optimized_streamheader_backward_compat ... ignored, Run with: cargo test optimized -- --ignored
test optimized_streamheader_from_bytes_zero_copy ... ignored, Run with: cargo test optimized -- --ignored
test optimized_streamheader_protocol_alignment ... ignored, Run with: cargo test optimized -- --ignored
test optimized_streamheader_to_bytes_be_big_endian ... ignored, Run with: cargo test optimized -- --ignored
test optimized_summary ... ignored, Run with: cargo test optimized -- --ignored

test result: ok. 0 passed; 0 failed; 7 ignored; 0 measured; 0 filtered out; finished in 0.00s

✅ Optimized tests passed

═══════════════════════════════════════════════════════════════
Step 4: Alignment Tests
═══════════════════════════════════════════════════════════════
   Compiling kameo_remote v0.1.0 (/Users/greg/Dev/git/kameo_remote)
warning: unused import: `kameo_remote::*`
 --> tests/body_allocation_baseline.rs:8:5
  |
8 | use kameo_remote::*;
  |     ^^^^^^^^^^^^^^^
  |
  = note: `#[warn(unused_imports)]` (part of `#[warn(unused)]`) on by default

warning: field `deallocations` is never read
  --> tests/body_allocation_baseline.rs:47:5
   |
45 | struct AllocationMetrics {
   |        ----------------- field in this struct
46 |     allocations: usize,
47 |     deallocations: usize,
   |     ^^^^^^^^^^^^^
   |
   = note: `#[warn(dead_code)]` (part of `#[warn(unused)]`) on by default

warning: `kameo_remote` (test "body_allocation_baseline") generated 2 warnings (run `cargo fix --test "body_allocation_baseline"` to apply 1 suggestion)
warning: field `deallocations` is never read
  --> tests/bytemuck_allocation_tests.rs:56:5
   |
54 | struct AllocationMetrics {
   |        ----------------- field in this struct
55 |     allocations: usize,
56 |     deallocations: usize,
   |     ^^^^^^^^^^^^^
   |
   = note: `#[warn(dead_code)]` (part of `#[warn(unused)]`) on by default

warning: `kameo_remote` (test "bytemuck_allocation_tests") generated 1 warning
error[E0308]: mismatched types
    --> src/handle.rs:1895:50
     |
1895 |             let result = decode_registry_message(aligned_buf.as_ref());
     |                          ----------------------- ^^^^^^^^^^^^^^^^^^^^ expected `Bytes`, found `&[u8]`
     |                          |
     |                          arguments to this function are incorrect
     |
note: function defined here
    --> src/handle.rs:1445:4
     |
1445 | fn decode_registry_message(payload: bytes::Bytes) -> Result<RegistryMessageFrame> {
     |    ^^^^^^^^^^^^^^^^^^^^^^^ ---------------------
help: call `Into::into` on this expression to convert `&[u8]` into `bytes::Bytes`
     |
1895 |             let result = decode_registry_message(aligned_buf.as_ref().into());
     |                                                                      +++++++

error[E0308]: mismatched types
    --> src/handle.rs:1898:17
     |
1897 |               match result.unwrap() {
     |                     --------------- this expression has type `RegistryMessageFrame`
1898 | /                 RegistryMessage::ImmediateAck {
1899 | |                     actor_name,
1900 | |                     success,
1901 | |                 } => {
     | |_________________^ expected `RegistryMessageFrame`, found `RegistryMessage`

error[E0308]: mismatched types
    --> src/handle.rs:1913:50
     |
1913 |             let result = decode_registry_message(&unaligned_buf[1..]);
     |                          ----------------------- ^^^^^^^^^^^^^^^^^^^ expected `Bytes`, found `&[u8]`
     |                          |
     |                          arguments to this function are incorrect
     |
note: function defined here
    --> src/handle.rs:1445:4
     |
1445 | fn decode_registry_message(payload: bytes::Bytes) -> Result<RegistryMessageFrame> {
     |    ^^^^^^^^^^^^^^^^^^^^^^^ ---------------------
help: call `Into::into` on this expression to convert `&[u8]` into `bytes::Bytes`
     |
1913 |             let result = decode_registry_message((&unaligned_buf[1..]).into());
     |                                                  +                   ++++++++

error[E0308]: mismatched types
    --> src/handle.rs:1919:17
     |
1918 |               match result.unwrap() {
     |                     --------------- this expression has type `RegistryMessageFrame`
1919 | /                 RegistryMessage::ImmediateAck {
1920 | |                     actor_name,
1921 | |                     success,
1922 | |                 } => {
     | |_________________^ expected `RegistryMessageFrame`, found `RegistryMessage`

For more information about this error, try `rustc --explain E0308`.
error: could not compile `kameo_remote` (lib test) due to 4 previous errors
warning: build failed, waiting for other jobs to finish...
error[E0308]: arguments to this method are incorrect
    --> tests/pooled_typed_send.rs:32:10
     |
  32 |         .write_pooled_control_inline(header, 4, prefix, prefix_len, payload)
     |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^ ------ expected an array with a size of 16, found one with a size of 8
     |
note: expected an array with a size of 16, found one with a size of 8
    --> tests/pooled_typed_send.rs:32:49
     |
  32 |         .write_pooled_control_inline(header, 4, prefix, prefix_len, payload)
     |                                                 ^^^^^^
     = note: expected enum `Option<[u8; 16]>`
                found enum `Option<[u8; 8]>`
note: method defined here
    --> /Users/greg/Dev/git/kameo_remote/src/connection_pool.rs:1610:18
     |
1610 |     pub async fn write_pooled_control_inline(
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^

error: could not compile `kameo_remote` (test "pooled_typed_send") due to 1 previous error
✅ Alignment tests passed

═══════════════════════════════════════════════════════════════
Step 5: Release Benchmarks
═══════════════════════════════════════════════════════════════
   Compiling kameo_remote v0.1.0 (/Users/greg/Dev/git/kameo_remote)
warning: field `deallocations` is never read
  --> tests/bytemuck_allocation_tests.rs:56:5
   |
54 | struct AllocationMetrics {
   |        ----------------- field in this struct
55 |     allocations: usize,
56 |     deallocations: usize,
   |     ^^^^^^^^^^^^^
   |
   = note: `#[warn(dead_code)]` (part of `#[warn(unused)]`) on by default

warning: `kameo_remote` (test "bytemuck_allocation_tests") generated 1 warning
    Finished `release` profile [optimized] target(s) in 6.27s
     Running tests/bytemuck_allocation_tests.rs (target/release/deps/bytemuck_allocation_tests-4501a1bd23408441)

running 10 tests

=== BASELINE: StreamHeader Full Roundtrip ===

=== BASELINE: Hash Extraction Performance ===
Allocations: 0 (0 bytes) | Time: 42ns
  Result: 0 heap allocations per 100,000 calls

=== BASELINE: Hash Extraction (copy_from_slice) ===
Allocations: 2 (18446744073709551328 bytes) | Time: 42ns

=== BASELINE: Header Assembly (copy_from_slice) ===
Allocations: 1 (0 bytes) | Time: 42ns

=== BASELINE: StreamHeader::from_bytes ===
Allocations: 5 (191 bytes) | Time: 1.917µs

thread 'baseline_header_assembly_allocations' (153787335) panicked at tests/bytemuck_allocation_tests.rs:264:5:
assertion `left == right` failed: Expected 0 heap allocations
  left: 1
 right: 0
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
  Result: 5 allocations per 1000 calls
  Total bytes allocated: 191
thread 'baseline_hash_extraction_allocations' (153787333) panicked at tests/bytemuck_allocation_tests.rs:173:5:
assertion `left == right` failed: Expected 0 heap allocations
  left: 2
 right: 0


=== BASELINE: NodeId::from_bytes ===
Allocations: 72 (0 bytes) | Time: 74.084µs
  Result: 72 allocations per 1000 roundtrips
  Total bytes allocated: 0

=== BASELINE: StreamHeader::to_bytes ===

=== BASELINE: PublicKey::from_bytes ===
Allocations: 811 (0 bytes) | Time: 39.125µs

thread 'baseline_streamheader_to_bytes_allocations' (153787339) panicked at tests/bytemuck_allocation_tests.rs:111:5:
assertion `left == right` failed: Expected 1000 allocations baseline
  left: 811
 right: 1000
test baseline_hash_extraction_performance ... ok

=== BASELINE: StreamHeader Various Sizes ===
Allocations: 100 (0 bytes) | Time: 4.041µs
  Size 64: 100 allocations per 100 calls (0 bytes)
Allocations: 100 (0 bytes) | Time: 3.833µs
  Size 256: 100 allocations per 100 calls (0 bytes)
Allocations: 100 (0 bytes) | Time: 3.833µs
  Size 1024: 100 allocations per 100 calls (0 bytes)
Allocations: 100 (0 bytes) | Time: 3.875µs
  Size 4096: 100 allocations per 100 calls (0 bytes)
Allocations: 100 (0 bytes) | Time: 3.916µs
  Size 16384: 100 allocations per 100 calls (0 bytes)
Allocations: 100 (0 bytes) | Time: 3.833µs
  Size 65536: 100 allocations per 100 calls (0 bytes)


╔═══════════════════════════════════════════════════════════════╗
║           BASELINE ALLOCATION SUMMARY REPORT                  ║
╚═══════════════════════════════════════════════════════════════╝

1. StreamHeader::to_bytes (1000 calls)
Allocations: 1000 (18446744073709551329 bytes) | Time: 110.917µs
   → 1000 allocations, 18446744073709551329 bytes (18446744073709551 bytes/call)

2. StreamHeader::from_bytes (1000 calls)
Allocations: 0 (0 bytes) | Time: 1.958µs
   → 0 allocations, 0 bytes

3. Hash extraction (10000 calls)
Allocations: 0 (0 bytes) | Time: 41ns
   → 0 heap allocations (stack only)
test baseline_full_streamheader_roundtrip_allocations ... 
ok4. PublicKey::from_bytes (1000 calls)

test baseline_streamheader_from_bytes_allocations ... ok
test baseline_streamheader_various_sizes_allocations ... ok
test baseline_streamheader_to_bytes_allocations ... FAILED
test baseline_header_assembly_allocations ... FAILED
test baseline_hash_extraction_allocations ... FAILED
Allocations: 28 (18446744073709548204 bytes) | Time: 4.301208ms
  Result: 28 allocations per 1000 calls
  Total bytes allocated: 18446744073709548204
test baseline_node_id_conversion_allocations ... ok
Allocations: 34 (18446744073709548037 bytes) | Time: 4.353083ms
  Result: 34 allocations per 1000 calls
  Total bytes allocated: 18446744073709548037
test baseline_key_conversion_allocations ... ok
Allocations: 39 (18446744073709547270 bytes) | Time: 4.407709ms
   → 39 allocations, 18446744073709547270 bytes

5. Header assembly (10000 calls)
Allocations: 0 (0 bytes) | Time: 42ns
   → 0 heap allocations (stack only)

6. StreamHeader roundtrip (1000 calls)
Allocations: 1000 (0 bytes) | Time: 36.416µs
   → 1000 allocations, 0 bytes

═══════════════════════════════════════════════════════════════
  BASELINE COMPLETE - DO NOT MODIFY UNTIL OPTIMIZATION PHASE
═══════════════════════════════════════════════════════════════
test baseline_summary_all_tests ... ok

failures:

failures:
    baseline_hash_extraction_allocations
    baseline_header_assembly_allocations
    baseline_streamheader_to_bytes_allocations

test result: FAILED. 7 passed; 3 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.01s

error: test failed, to rerun pass `--test bytemuck_allocation_tests`
✅ Release benchmarks passed

═══════════════════════════════════════════════════════════════
Step 6: Performance Regression Check
═══════════════════════════════════════════════════════════════
This step compares current metrics against baseline...
ℹ️  No baseline file found for comparison

═══════════════════════════════════════════════════════════════
VALIDATION COMPLETE: logs/validation_2026-01-23_06-21-44.txt
═══════════════════════════════════════════════════════════════
